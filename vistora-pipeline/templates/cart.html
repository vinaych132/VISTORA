<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Your Cart - Vistora</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
  <header>
    <h1>Vistora</h1>
    <nav>
  <a href="{{ url_for('home') }}">Home</a>
  <a href="{{ url_for('cart') }}" class="active">
    ðŸ›’ Cart ({{ cart_data|length }})
  </a>
</nav>
  </header>

  <main>
    <h2>Your Shopping Cart</h2>

    <div class="cart-items" id="cart-items">
      <!-- Cart items will be dynamically inserted here -->
    </div>

    <div class="cart-summary">
      <h3>Total: â‚¹<span id="total-price">0</span></h3>
      <a href="/billing"><button class="checkout-btn">Proceed to Checkout</button></a>
    </div>
  </main>

  <script>
    // Function to get cart data from localStorage
    const getCartData = () => {
      return JSON.parse(localStorage.getItem('cart')) || [];
    };

    // Function to update cart count and total price
    const updateCartInfo = () => {
      const cartData = getCartData();
      const cartCount = cartData.length;
      const totalPrice = cartData.reduce((acc, item) => acc + item.price * item.quantity, 0);
      document.getElementById('cart-count').textContent = cartCount;
      document.getElementById('total-price').textContent = totalPrice;
    };

    // Function to remove an item from the cart
    const removeItemFromCart = (index) => {
      const cartData = getCartData();
      cartData.splice(index, 1); // Remove item by index
      localStorage.setItem('cart', JSON.stringify(cartData));
      renderCartItems();
      updateCartInfo();
    };

    // Function to render cart items on the page
    const renderCartItems = () => {
      const cartItemsContainer = document.getElementById('cart-items');
      const cartData = getCartData();
      cartItemsContainer.innerHTML = '';

      cartData.forEach((item, index) => {
        const itemDiv = document.createElement('div');
        itemDiv.classList.add('cart-item');

        itemDiv.innerHTML = `
          <img src="${item.image}" alt="Product Image">
          <div>
            <h3>${item.name}</h3>
            <p>Quantity: ${item.quantity}</p>
            <p>Price: â‚¹${item.price}</p>
            <button class="remove-btn" onclick="removeItemFromCart(${index})">Remove</button>
          </div>
        `;

        cartItemsContainer.appendChild(itemDiv);
      });
    };

    // Initialize cart on page load
    window.onload = () => {
      renderCartItems();
      updateCartInfo();
    };
  </script>
</body>
</html>
